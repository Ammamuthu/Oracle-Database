C and D
========

mkdir D:\ims_ecs\Oracle\fast_recovery_area
mkdir D:\ims_ecs\Oracle\arch\IMS
mkdir D:\ims_ecs\Oracle\standby\IMS

Open Oracle Net Manger:(tnsname.ora) -> SAME AS ALL NODES
======================

IMS_P
IMS_P_DGB
IMS_P_DGMGRL

IMS_D
IMS_D_DGB
IMS_D_DGMGRL

IMS_PROD
IMS_PROD_DGB
IMS_PROD_DGMGRL

IMS_DR
IMS_DR_DGB
IMS_DR_DGMGRL

(on standby)        -- add it in Listerner.ora

C ---->

SID_LIST_LISTENER = 
   (SID_LIST = 
     (SID_DESC = 
       (GLOBAL_DBNAME = IMS) 
       (ORACLE_HOME = D:\ims_ecs\Oracle\WINDOWS.X64_193000_db_home) 
       (SID_NAME = IMS) 
     ) 
     (SID_DESC = 
       (GLOBAL_DBNAME = IMS_PROD) 
       (ORACLE_HOME = D:\ims_ecs\Oracle\WINDOWS.X64_193000_db_home) 
       (SID_NAME = IMS) 
     ) 
     (SID_DESC = 
       (GLOBAL_DBNAME = IMS_PROD_DGB) 
       (ORACLE_HOME = D:\ims_ecs\Oracle\WINDOWS.X64_193000_db_home) 
       (SID_NAME = IMS) 
     ) 
     (SID_DESC = 
       (GLOBAL_DBNAME = IMS_PROD_DGMGRL) 
       (ORACLE_HOME = D:\ims_ecs\Oracle\WINDOWS.X64_193000_db_home) 
       (SID_NAME = IMS) 
     ) 
   ) 


D -->


SID_LIST_LISTENER = 
   (SID_LIST = 
     (SID_DESC = 
       (GLOBAL_DBNAME = IMS) 
       (ORACLE_HOME = D:\ims_ecs\Oracle\WINDOWS.X64_193000_db_home) 
       (SID_NAME = IMS) 
     ) 
     (SID_DESC = 
       (GLOBAL_DBNAME = IMS_DR) 
       (ORACLE_HOME = D:\ims_ecs\Oracle\WINDOWS.X64_193000_db_home) 
       (SID_NAME = IMS) 
     ) 
     (SID_DESC = 
       (GLOBAL_DBNAME = IMS_DR_DGB) 
       (ORACLE_HOME = D:\ims_ecs\Oracle\WINDOWS.X64_193000_db_home) 
       (SID_NAME = IMS) 
     ) 
     (SID_DESC = 
       (GLOBAL_DBNAME = IMS_DR_DGMGRL) 
       (ORACLE_HOME = D:\ims_ecs\Oracle\WINDOWS.X64_193000_db_home) 
       (SID_NAME = IMS) 
     ) 
   ) 
    

PRIMARY - A SIDE :
================

CREATE PFILE='D:\ims_ecs\Oracle\WINDOWS.X64_193000_db_home\database\INIT_IMS_P.ora' FROM SPFILE;

ALTER SYSTEM SET db_unique_name='IMS_P' SCOPE=BOTH;
ALTER SYSTEM SET FAL_Client='IMS_P' SCOPE=BOTH;
ALTER SYSTEM SET FAL_Server='IMS_D,IMS_PROD,IMS_DR' SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_config='DG_CONFIG=(IMS_P,IMS_D,IMS_PROD,IMS_DR)' SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_1='LOCATION=D:\IMS_ECS\oracle\arch\IMS VALID_FOR=(ALL_LOGFILES,ALL_ROLES) db_unique_name=IMS_P' SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_2='Service=IMS_D lgwr async VALID_FOR=(ALL_LOGFILES,PRIMARY_ROLE) compression=enable db_unique_name=IMS_D' SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_3='Service=IMS_PROD lgwr async VALID_FOR=(ALL_LOGFILES,PRIMARY_ROLE) compression=enable db_unique_name=IMS_PROD' SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_4='Service=IMS_DR lgwr async VALID_FOR=(ALL_LOGFILES,PRIMARY_ROLE) compression=enable db_unique_name=IMS_DR' SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_state_1=ENABLE SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_state_2=DEFER SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_state_3=DEFER SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_state_4=DEFER SCOPE=BOTH;
ALTER SYSTEM SET Standby_File_Management='AUTO'  SCOPE=BOTH;
ALTER SYSTEM SET CONTROL_FILE_RECORD_KEEP_TIME=30  SCOPE=BOTH;
ALTER SYSTEM SET Service_names='IMS_P'   SCOPE=BOTH;
ALTER SYSTEM SET DG_BROKER_START=TRUE SCOPE=BOTH;


-- Shutdown and startup mount

	SHUTDOWN IMMEDIATE;
	STARTUP MOUNT;

STANDBY - B SIDE :
================

CREATE PFILE='D:\ims_ecs\Oracle\WINDOWS.X64_193000_db_home\database\INIT_IMS_D.ora' FROM SPFILE;

ALTER SYSTEM SET db_unique_name='IMS_D'  SCOPE=BOTH;
ALTER SYSTEM SET FAL_Client='IMS_D'  SCOPE=BOTH;
ALTER SYSTEM SET FAL_Server='IMS_P,IMS_PROD,IMS_DR'  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_config='DG_CONFIG=(IMS_P,IMS_D,IMS_PROD,IMS_DR)'  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_1='LOCATION=D:\IMS_ECS\oracle\arch\IMS VALID_FOR=(ALL_LOGFILES,ALL_ROLES) db_unique_name=IMS_D'  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_2='Service=IMS_P lgwr async VALID_FOR=(ALL_LOGFILES,PRIMARY_ROLE) compression=enable db_unique_name=IMS_P'  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_3='Service=IMS_PROD lgwr async VALID_FOR=(ALL_LOGFILES,PRIMARY_ROLE) compression=enable db_unique_name=IMS_PROD'  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_4='Service=IMS_DR lgwr async VALID_FOR=(ALL_LOGFILES,PRIMARY_ROLE) compression=enable db_unique_name=IMS_DR'  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_state_1=ENABLE  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_state_2=ENABLE  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_state_3=ENABLE  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_state_4=ENABLE  SCOPE=BOTH;
ALTER SYSTEM SET Service_names='IMS_D'  SCOPE=BOTH;
ALTER SYSTEM SET CONTROL_FILE_RECORD_KEEP_TIME=30  SCOPE=BOTH;
ALTER SYSTEM SET Standby_File_Management='AUTO'   SCOPE=BOTH;
ALTER SYSTEM SET DG_BROKER_START=TRUE SCOPE=BOTH;

STANDBY - C SIDE :
================

CREATE PFILE='D:\ims_ecs\Oracle\WINDOWS.X64_193000_db_home\database\INIT_IMS_PROD.ora' FROM SPFILE;

ALTER SYSTEM SET db_unique_name='IMS_PROD'  SCOPE=BOTH;
ALTER SYSTEM SET FAL_Client='IMS_PROD'  SCOPE=BOTH;
ALTER SYSTEM SET FAL_Server='IMS_P,IMS_D,IMS_DR'  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_config='DG_CONFIG=(IMS_P,IMS_D,IMS_PROD,IMS_DR)'  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_1='LOCATION=D:\IMS_ECS\oracle\arch\IMS VALID_FOR=(ALL_LOGFILES,ALL_ROLES) db_unique_name=IMS_PROD'  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_2='Service=IMS_P lgwr async VALID_FOR=(ALL_LOGFILES,PRIMARY_ROLE) compression=enable db_unique_name=IMS_P'  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_3='Service=IMS_D lgwr async VALID_FOR=(ALL_LOGFILES,PRIMARY_ROLE) compression=enable db_unique_name=IMS_D'  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_4='Service=IMS_DR lgwr async VALID_FOR=(ALL_LOGFILES,PRIMARY_ROLE) compression=enable db_unique_name=IMS_DR'  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_state_1=ENABLE  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_state_2=ENABLE  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_state_3=ENABLE  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_state_4=ENABLE  SCOPE=BOTH;
ALTER SYSTEM SET Service_names='IMS_PROD'  SCOPE=BOTH;
ALTER SYSTEM SET CONTROL_FILE_RECORD_KEEP_TIME=30  SCOPE=BOTH;
ALTER SYSTEM SET Standby_File_Management='AUTO'  SCOPE=BOTH;
ALTER SYSTEM SET DG_BROKER_START=TRUE SCOPE=BOTH;

STANDBY - D SIDE :
================

CREATE PFILE='D:\ims_ecs\Oracle\WINDOWS.X64_193000_db_home\database\INIT_IMS_DR.ora' FROM SPFILE;

ALTER SYSTEM SET db_unique_name='IMS_DR'  SCOPE=BOTH;
ALTER SYSTEM SET FAL_Client='IMS_DR'  SCOPE=BOTH;
ALTER SYSTEM SET FAL_Server='IMS_P,IMS_D,IMS_PROD'  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_config='DG_CONFIG=(IMS_P,IMS_D,IMS_PROD,IMS_DR)'  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_1='LOCATION=D:\IMS_ECS\oracle\arch\IMS VALID_FOR=(ALL_LOGFILES,ALL_ROLES) db_unique_name=IMS_PROD'  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_2='Service=IMS_P lgwr async VALID_FOR=(ALL_LOGFILES,PRIMARY_ROLE) compression=enable db_unique_name=IMS_P'  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_3='Service=IMS_D lgwr async VALID_FOR=(ALL_LOGFILES,PRIMARY_ROLE) compression=enable db_unique_name=IMS_D'  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_4='Service=IMS_PROD lgwr async VALID_FOR=(ALL_LOGFILES,PRIMARY_ROLE) compression=enable db_unique_name=IMS_PROD'  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_state_1=ENABLE  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_state_2=ENABLE  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_state_3=ENABLE  SCOPE=BOTH;
ALTER SYSTEM SET Log_archive_dest_state_4=ENABLE  SCOPE=BOTH;
ALTER SYSTEM SET Service_names='IMS_DR'  SCOPE=BOTH;
ALTER SYSTEM SET CONTROL_FILE_RECORD_KEEP_TIME=30  SCOPE=BOTH;
ALTER SYSTEM SET Standby_File_Management='AUTO'  SCOPE=BOTH;
ALTER SYSTEM SET DG_BROKER_START=TRUE SCOPE=BOTH;

Standby Side's :(both)
================

-- Enable archive log mode and flashback
ALTER DATABASE ARCHIVELOG;
ALTER SYSTEM SET db_recovery_file_dest_size = 20G SCOPE=BOTH;
ALTER SYSTEM SET db_flashback_retention_target = 7200 SCOPE=BOTH;
ALTER SYSTEM SET db_recovery_file_dest = 'D:\ims_ecs\Oracle\fast_recovery_area' SCOPE=BOTH;
ALTER DATABASE FLASHBACK ON;



-- Add standby log files (adjust paths if needed)
ALTER DATABASE ADD STANDBY LOGFILE GROUP 4 'D:\ims_ecs\Oracle\standby\IMS\redo04.log' SIZE 200M;
ALTER DATABASE ADD STANDBY LOGFILE GROUP 5 'D:\ims_ecs\Oracle\standby\IMS\redo05.log' SIZE 200M;
ALTER DATABASE ADD STANDBY LOGFILE GROUP 6 'D:\ims_ecs\Oracle\standby\IMS\redo06.log' SIZE 200M;
ALTER DATABASE ADD STANDBY LOGFILE GROUP 7 'D:\ims_ecs\Oracle\standby\IMS\redo07.log' SIZE 200M;

RMAN Duplicate from prod:
==========================

rman TARGET sys/password@IMS_P AUXILIARY sys/password@IMS_PROD

DUPLICATE TARGET DATABASE
  FOR STANDBY
  FROM ACTIVE DATABASE
  DORECOVER
  SPFILE
    SET db_unique_name='IMS_PROD' COMMENT 'Standby C'
  NOFILENAMECHECK;

-- Repeat for IMS_DR
rman TARGET sys/password@IMS_P AUXILIARY sys/password@IMS_DR

DUPLICATE TARGET DATABASE
  FOR STANDBY
  FROM ACTIVE DATABASE
  DORECOVER
  SPFILE
    SET db_unique_name='IMS_DR' COMMENT 'Standby D'
  NOFILENAMECHECK;


start MRP :
===========


-- Start managed recovery with apply (read-only standby)
ALTER DATABASE RECOVER MANAGED STANDBY DATABASE USING CURRENT LOGFILE DISCONNECT FROM SESSION;

dgmgrl sys/password@IMS_P

-- Add IMS_PROD
ADD DATABASE 'IMS_PROD' AS CONNECT IDENTIFIER IS 'IMS_PROD' MAINTAINED AS PHYSICAL;

-- Add IMS_DR
ADD DATABASE 'IMS_DR' AS CONNECT IDENTIFIER IS 'IMS_DR' MAINTAINED AS PHYSICAL;

-- Enable configuration and set properties
ENABLE CONFIGURATION;

EDIT DATABASE 'IMS_PROD' SET STATE='APPLY-ON';
EDIT DATABASE 'IMS_DR' SET STATE='APPLY-ON';

-- Adjust protection mode and other properties
EDIT CONFIGURATION SET PROTECTION MODE AS MAXPERFORMANCE;

-- Optional tuning properties
EDIT DATABASE 'IMS_PROD' SET PROPERTY 'TransportDisconnectedThreshold'=0;
EDIT DATABASE 'IMS_DR' SET PROPERTY 'TransportDisconnectedThreshold'=0;

EDIT DATABASE 'IMS_PROD' SET PROPERTY 'LogXptMode'='SYNC';
EDIT DATABASE 'IMS_DR' SET PROPERTY 'LogXptMode'='SYNC';

EDIT DATABASE 'IMS_PROD' SET PROPERTY 'REDOCOMPRESSION'='ENABLE';
EDIT DATABASE 'IMS_DR' SET PROPERTY 'REDOCOMPRESSION'='ENABLE';

EDIT DATABASE 'IMS_PROD' SET PROPERTY 'ArchiveLagTarget'=1200;
EDIT DATABASE 'IMS_DR' SET PROPERTY 'ArchiveLagTarget'=1200;

EDIT DATABASE 'IMS_PROD' SET PROPERTY 'LogArchiveMaxProcesses'=10;
EDIT DATABASE 'IMS_DR' SET PROPERTY 'LogArchiveMaxProcesses'=10;

EDIT DATABASE 'IMS_PROD' SET PROPERTY 'LogArchiveMinSucceedDest'=1;
EDIT DATABASE 'IMS_DR' SET PROPERTY 'LogArchiveMinSucceedDest'=1;

SHOW CONFIGURATION;
SHOW DATABASE VERBOSE IMS_PROD;
SHOW DATABASE VERBOSE IMS_DR;